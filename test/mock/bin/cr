#!/usr/bin/env bash
#
# Mocked `cr` (chart-releaser) executable.
#

shopt -s inherit_errexit
set -eu -o pipefail

readonly SUB_COMMAND="${1:-}"

printf "#\n# Mocked:\n#\t%s %s\n#\n" $(basename ${0}) "${*}"

# skipping any other subcommands than `package`...
[[ "${SUB_COMMAND}" != "package" ]] && \
	exit 0

# when `cr package` is invoked it expects to find the chart tarball in the destination directory,
# thus here we are using `helm` mimic the expected behaviour
set -x
readonly DESTINATION=".cr-release-packages"
mkdir -v ${DESTINATION}
exec helm package --destination="${DESTINATION}" .
